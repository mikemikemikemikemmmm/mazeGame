(this.webpackJsonppixi2=this.webpackJsonppixi2||[]).push([[0],{12:function(i,t,e){i.exports=e(22)},22:function(i,t,e){"use strict";e.r(t);var s=e(4),a=e(5),h=e(1),n=e(6),r=function(){function i(t){Object(s.a)(this,i),this.maze=void 0,this.roadRun=void 0,this.backPointList=void 0,this.startPositionIndex=void 0,this.endIndex=void 0,this.rowLegnth=void 0,this.directionList=void 0,this.rowLegnth=t||25,this.directionList=[[-1,0],[0,1],[1,0],[0,-1]],this.roadRun="",this.startPositionIndex=(this.rowLegnth-1)/2,this.backPointList=[],this.maze=this.createEmptyMaze(),this.init()}return Object(a.a)(i,[{key:"createMazeRow",value:function(){for(var i=["0"],t=(this.rowLegnth-1)/2,e=0;e<t;e++)i.push("2"),e+1!==t&&i.push("1");return i.push("0"),i}},{key:"createEmptyMaze",value:function(){var i=this,t=[],e=function(){for(var t=["0"],e=0;e<i.rowLegnth-2;e++)t.push("1");return t.push("0"),t}(),s=function(){for(var t=[],e=0;e<i.rowLegnth;e++)t.push("0");return t}();t.push(Object(n.a)(s));for(var a=1;a<this.rowLegnth/2;a++)t.push(this.createMazeRow()),a!==(this.rowLegnth-1)/2&&t.push(Object(n.a)(e));return t.push(Object(n.a)(s)),t[this.startPositionIndex][this.startPositionIndex]="6",[].concat(t)}},{key:"checkAround",value:function(i,t){var e,s,a=this,h=["","","",""],n=function(h){return a.maze[i+e*h]&&a.maze[i+e*h][t+s*h]?String(a.maze[i+e*h][t+s*h]):"5"};return this.directionList.forEach((function(i,t){e=i[0],s=i[1],h[t]=n(1)+n(2)})),h}},{key:"handleNextDirection",value:function(i){if(-1!==i.indexOf("12")){var t=[];i.forEach((function(i,e){"12"===i&&t.push({value:i,index:e})}));for(var e=Math.floor(Math.random()*t.length);e===t.length;)e=Math.floor(Math.random()*t.length);return{index_direction:t[e].index,colChangeTo:"3",status:"roading"}}var s;if(-1!==i.indexOf("36")){for(var a in i)"36"===i[a]&&(s=a);return{index_direction:s,colChangeTo:"4",status:"backToStart"}}if(-1===i.indexOf("44")&&-1!==i.indexOf("33")){for(var h in i)"33"===i[h]&&(s=h);return{index_direction:s,colChangeTo:"4",status:"backPoint"}}if(-1!==i.indexOf("33")){for(var n in i)"33"===i[n]&&(s=n);return{index_direction:s,colChangeTo:"4",status:"backing"}}}},{key:"createEnd",value:function(){this.backPointList.sort((function(i,t){return t.stepNum-i.stepNum})),this.endIndex={row:this.backPointList[0].rowIndex,col:this.backPointList[0].colIndex},this.maze[this.backPointList[0].rowIndex][this.backPointList[0].colIndex]="7"}},{key:"init",value:function(){for(var i=this.startPositionIndex,t=this.startPositionIndex;;){var e=this.handleNextDirection(this.checkAround(i,t)),s=e.index_direction,a=e.colChangeTo,h=e.status,n=this.directionList[s][0],r=this.directionList[s][1];if("6"!==this.maze[i][t]&&(this.maze[i][t]=a),this.maze[i+n][t+r]=a,"backToStart"===h){this.roadRun+=s;break}"roading"===h?this.roadRun+=s:"backPoint"===h?(this.roadRun=this.roadRun.slice(0,-1),this.backPointList.push({rowIndex:i,colIndex:t,stepNum:this.roadRun.length})):"backing"===h&&(this.roadRun=this.roadRun.slice(0,-1)),i+=2*n,t+=2*r}this.createEnd()}}]),i}(),o=function(){function i(t,e){Object(s.a)(this,i),this.screenWidth=void 0,this.rowLength=void 0,this.tileWidth=void 0,this.ballSpeed=void 0,this.ballRadius=void 0,this.ballDiameter=void 0,this.directionData=void 0,this.app=void 0,this.maze=void 0,this.appContainer=void 0,this.keyBoardStatus=void 0,this.endCoordinates=void 0,this.endBounds=void 0,this.mazeGraphics=void 0,this.ballGraphics=void 0,this.keyBoardData=void 0,this.bindHandlePress=void 0,this.bindHandleUnPress=void 0,this.bindGameLoop=void 0,this.rowLength=e,this.screenWidth=t,this.tileWidth=t/e,this.ballSpeed=this.tileWidth/3,this.ballRadius=this.tileWidth/4,this.ballDiameter=2*this.ballRadius,this.app=new h.a({width:this.screenWidth,height:this.screenWidth,backgroundColor:16777215}),this.init()}return Object(a.a)(i,[{key:"resetConfig",value:function(){this.app.ticker.remove(this.bindGameLoop),this.appContainer.destroy({children:!0,texture:!0,baseTexture:!0})}},{key:"init",value:function(){this.appContainer=new h.b,this.bindHandlePress=this.handleKeyBoardPress.bind(this),this.bindHandleUnPress=this.handleKeyBoardUnPress.bind(this),this.maze=new r(this.rowLength),this.keyBoardStatus={w:!1,a:!1,s:!1,d:!1},this.endCoordinates=this.mazeIndexMapToCanvasCoordinate(this.maze.endIndex.row,this.maze.endIndex.col),this.endBounds={x:this.endCoordinates[0][0],y:this.endCoordinates[0][1],width:this.tileWidth,height:this.tileWidth},this.ballGraphics=this.createBallGraphics(),this.mazeGraphics=this.createMazeGraphics(),this.appContainer.addChild(this.mazeGraphics,this.ballGraphics),this.ballGraphics.x=this.screenWidth/2-this.ballRadius,this.ballGraphics.y=this.screenWidth/2-this.ballRadius,this.app.stage.addChild(this.appContainer),this.bindGameLoop=this.gameLoop.bind(this),this.app.ticker.add(this.bindGameLoop),this.initKeyListener()}},{key:"isWin",value:function(){return this.ballGraphics.x+this.ballDiameter>this.endBounds.x&&this.ballGraphics.x<this.endBounds.x+this.endBounds.width&&this.ballGraphics.y+this.ballDiameter>this.endBounds.y&&this.ballGraphics.y<this.endBounds.y+this.endBounds.height}},{key:"handleWin",value:function(){this.removeKeyListender(),window.confirm("win\uff0canother game?")?(this.resetConfig(),this.init()):this.app.ticker.stop()}},{key:"createBallGraphics",value:function(){var i=new h.c;return i.beginFill(16711680),i.drawCircle(this.ballRadius,this.ballRadius,this.ballRadius),i.endFill(),i}},{key:"createMazeGraphics",value:function(){var i=this,t=new h.c;return this.maze.maze.forEach((function(e,s){e.forEach((function(e,a){if("1"===e||"0"===e)t.beginFill(0),t.drawRect(i.tileWidth*s,i.tileWidth*a,i.tileWidth,i.tileWidth),t.endFill();else if("7"===e){var n=new h.d("\u7d42",{fontSize:i.tileWidth,fill:16711680,fontWeight:900,align:""});t.addChild(n),n.x=s*i.tileWidth+(i.tileWidth-n.width)/2,n.y=a*i.tileWidth+(i.tileWidth-n.width)/2}}))})),t}},{key:"initKeyListener",value:function(){document.addEventListener("keyup",this.bindHandleUnPress),document.addEventListener("keydown",this.bindHandlePress)}},{key:"removeKeyListender",value:function(){console.log("remove"),document.removeEventListener("keyup",this.bindHandleUnPress),document.removeEventListener("keydown",this.bindHandlePress)}},{key:"handleKeyBoardPress",value:function(i){var t=i.key;t in this.keyBoardStatus&&(this.keyBoardStatus[t]=!0)}},{key:"handleKeyBoardUnPress",value:function(i){var t=i.key;t in this.keyBoardStatus&&(this.keyBoardStatus[t]=!1)}},{key:"mazeIndexMapToCanvasCoordinate",value:function(i,t){var e=this,s=[i*this.tileWidth,t*this.tileWidth];return[s,s.map((function(i){return i+e.tileWidth}))]}},{key:"isWallByXY",value:function(i,t){var e=this.maze.maze[Math.ceil(i/this.tileWidth)-1][Math.ceil(t/this.tileWidth)-1];return"0"===e||"1"===e}},{key:"getMaxCoordinates",value:function(i,t,e){switch(i){case"up":return Math.floor(e-e%this.tileWidth+1);case"right":return Math.ceil(t-(t+this.ballDiameter)%this.tileWidth+this.tileWidth-1);case"down":return Math.ceil(e-(e+this.ballDiameter)%this.tileWidth+this.tileWidth-1);case"left":return Math.floor(t-t%this.tileWidth+1)}}},{key:"isTouchWall",value:function(i,t,e){switch(i){case"up":if(this.isWallByXY(t,e-this.ballSpeed)||this.isWallByXY(t+this.ballDiameter,e-this.ballSpeed))return!0;break;case"right":if(this.isWallByXY(t+this.ballDiameter+this.ballSpeed,e)||this.isWallByXY(t+this.ballDiameter+this.ballSpeed,e+this.ballDiameter))return!0;break;case"down":if(this.isWallByXY(t,e+this.ballDiameter+this.ballSpeed)||this.isWallByXY(t+this.ballDiameter,e+this.ballDiameter+this.ballSpeed))return!0;break;case"left":if(this.isWallByXY(t-this.ballSpeed,e)||this.isWallByXY(t-this.ballSpeed,e+this.ballDiameter))return!0}return!1}},{key:"gameLoop",value:function(){if(this.keyBoardStatus.w){if(this.isWin())return void this.handleWin();var i=this.ballGraphics,t=i.x,e=i.y;this.isTouchWall("up",t,e)?this.ballGraphics.y=this.getMaxCoordinates("up",t,e):this.ballGraphics.y-=this.ballSpeed}if(this.keyBoardStatus.a){if(this.isWin())return void this.handleWin();var s=this.ballGraphics,a=s.x,h=s.y;this.isTouchWall("left",a,h)?this.ballGraphics.x=this.getMaxCoordinates("left",a,h):this.ballGraphics.x-=this.ballSpeed}if(this.keyBoardStatus.s){if(this.isWin())return void this.handleWin();var n=this.ballGraphics,r=n.x,o=n.y;this.isTouchWall("down",r,o)?this.ballGraphics.y=this.getMaxCoordinates("down",r,o):this.ballGraphics.y+=this.ballSpeed}if(this.keyBoardStatus.d){if(this.isWin())return void this.handleWin();var d=this.ballGraphics,l=d.x,c=d.y;this.isTouchWall("right",l,c)?this.ballGraphics.x=this.getMaxCoordinates("right",l,c):this.ballGraphics.x+=this.ballSpeed}}}]),i}(),d=document.querySelector("body");d.style.margin=0,d.style.padding=0;var l=window,c=l.innerHeight,u=l.innerWidth,p=new o(Math.min(c,u),19);document.body.appendChild(p.app.view)}},[[12,1,2]]]);
//# sourceMappingURL=main.7bc0089c.chunk.js.map